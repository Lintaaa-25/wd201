<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Todo App</title>
  <link rel="stylesheet" href="/styles.css">
</head>
<body>
  <h1>Todo List</h1>

  <!-- Form to add a new Todo -->
  <form action="/todos" method="POST">
    <input type="hidden" name="_csrf" value="<%= csrfToken %>">
    <input type="text" name="title" placeholder="Title" required>
    <input type="date" name="dueDate" required>
    <button type="submit">Add Todo</button>
  </form>

  <h2>Overdue</h2>
  <ul>
    <% overdue.forEach(todo => { %>
      <li>
        <%= todo.title %> - Due: <%= todo.dueDate %>
        <form action="/todos/<%= todo.id %>?_method=PUT" method="POST">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <label for="completed">Completed:</label>
          <input type="checkbox" name="completed" <%= todo.completed ? 'checked' : '' %> onchange="this.form.submit()">
        </form>
      </li>
    <% }) %>
  </ul>

  <h2>Due Today</h2>
  <ul>
    <% dueToday.forEach(todo => { %>
      <li>
        <%= todo.title %> - Due: <%= todo.dueDate %>
        <form action="/todos/<%= todo.id %>?_method=PUT" method="POST">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <label for="completed">Completed:</label>
          <input type="checkbox" name="completed" <%= todo.completed ? 'checked' : '' %> onchange="this.form.submit()">
        </form>
      </li>
    <% }) %>
  </ul>

  <h2>Due Later</h2>
  <ul>
    <% dueLater.forEach(todo => { %>
      <li>
        <%= todo.title %> - Due: <%= todo.dueDate %>
        <form action="/todos/<%= todo.id %>?_method=PUT" method="POST">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <label for="completed">Completed:</label>
          <input type="checkbox" name="completed" <%= todo.completed ? 'checked' : '' %> onchange="this.form.submit()">
        </form>
      </li>
    <% }) %>
  </ul>

  <h2>Completed</h2>
  <ul>
    <% completed.forEach(todo => { %>
      <li>
        <%= todo.title %> - Completed on: <%= todo.dueDate %>
        <form action="/todos/<%= todo.id %>?_method=DELETE" method="POST">
          <input type="hidden" name="_csrf" value="<%= csrfToken %>">
          <button type="submit">Delete</button>
        </form>
      </li>
    <% }) %>
  </ul>

  <script src="/app.js"></script>
</body>
</html>
